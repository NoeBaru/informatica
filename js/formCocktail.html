<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cocktail</title>
</head>
<body>
    <h1>Inserisci Cocktail</h1>
    <form>
        <label id="nome_cocktail"> Cocktail: <input type="text" id="cocktail" name="cocktail"><br> </label>
    </form>
    <input type="submit" id="controlla" value="controlla">

    <div id="messaggi"></div>
    <body>

        <select id="select_cocktail" name="select_cocktail">
           <!-- <option value="Torino">Torino</option>-->
        </select>
    
    
    
            
        <script>
            /*********
             utilizzo il webserver di VSC 
             **********/
    
            let url = "https://www.thecocktaildb.com/api/json/v1/1/search.php?s=margarita" //url che punta al json... puÃ² essere anche un url sul web
            let select_cocktail = document.getElementById("select_cocktail")
    
    
            fetch(url)
                .then(response => response.json()) //richiamo la funzione json
                .then(dati => {
                    const datiJson = dati
                    console.log(datiJson) //stampo l'oggetto creato dall'importazione del json
                    
                    console.log("cocktail nome = " + datiJson.strDrink)
    
                    datiJson.provincia.forEach(element =>{ //scorro l'array di oggetti presente in provincia
                        console.log("--", element.strDrink)
    
                        if (element.comuni.length > 0){
                            element.comuni.forEach(dati_comune =>{ //scorro l'array di oggetti presente in comuni
                                console.log("---- " + dati_comune.comune_nome + " " + dati_comune.cap)
    
                                createOptionProvincia(element.provincia_nome + " " + dati_comune.comune_nome + " " + dati_comune.cap)
                            })
                                
                        }
    
                    }) 
                })
    
                function createOptionProvincia(valore){
                    select_provincia.insertAdjacentHTML('beforeend','<option value="' + valore +'">'+ valore +'</option>')
                }
    
                select_provincia.addEventListener("change", function(e){
                    console.log(e.target.value) //stampa in console il valore selezionato
                    
                                 
                })
    
    
    
    
    
                
    
                    /*********************************
                    Sintassi per scorrere una lista di oggetti
                    Si usa Object.keys
    
                    Object.keys(datiJson.provincia).forEach(key => {
                        console.log(key)
                    })
                    *********************************/
       </script>
    </body>
</html>